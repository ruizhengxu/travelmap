<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆ‘çš„å¤§è¥¿åŒ—æ·±åº¦æ¸¸åœ°å›¾</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Microsoft YaHei", sans-serif; }
        #map { height: 100vh; width: 100%; background: #f0f0f0; }

        /* --- 1. åœ°å›¾æ ‡ç­¾æ ·å¼ (ç™½åº•å¡ç‰‡é£) --- */
        .map-label {
            background: rgba(255, 255, 255, 0.95) !important;
            border: 1px solid #ccc !important;
            border-radius: 4px;
            box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
            font-size: 13px;
            font-weight: bold;
            color: #333 !important;
            padding: 3px 8px;
            white-space: nowrap;
            pointer-events: auto; 
            cursor: pointer;
        }

        /* --- 2. å¼¹çª—åŸºç¡€æ ·å¼ --- */
        .leaflet-popup-content-wrapper { 
            border-radius: 10px; 
            padding: 0; 
            overflow: hidden; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
        }
        .leaflet-popup-content { margin: 0 !important; width: 360px !important; }
        
        .popup-header {
            background: linear-gradient(135deg, #0062cc, #0096ff);
            color: white;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .popup-body { 
            padding: 15px; 
            max-height: 60vh; /* ç¨å¾®å¢åŠ é«˜åº¦ */
            overflow-y: auto; 
            background: #fff;
        }

        /* --- 3. å†…å®¹åŒºåŸŸæ ·å¼ --- */
        .my-notes-box {
            background-color: #fffbf0;
            border: 1px solid #ffeeba;
            border-left: 5px solid #ffc107;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .section-title { font-size: 12px; color: #999; font-weight: 800; margin-bottom: 6px; display: block; letter-spacing: 1px; }
        .my-notes-list { margin: 0; padding-left: 18px; font-size: 15px; color: #d35400; font-weight: 600; line-height: 1.6; }
        
        .desc-box { font-size: 14px; color: #444; line-height: 1.8; margin-bottom: 15px; text-align: justify; }
        .desc-box strong { color: #2c3e50; }
        
        .tag-container { margin-bottom: 10px; }
        .tag { 
            display: inline-block; 
            background: #eef2f7; 
            color: #5a6e8c; 
            padding: 3px 8px; 
            border-radius: 12px; 
            font-size: 12px; 
            margin-right: 6px; 
            margin-bottom: 5px;
        }

        /* --- 4. ç›¸å†Œæ ·å¼ --- */
        .photo-section { border-top: 1px solid #eee; padding-top: 15px; margin-bottom: 15px;}
        
        .carousel-container {
            position: relative;
            width: 100%;
            height: 220px;
            background-color: #222;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        .carousel-slide { width: 100%; height: 100%; display: none; }
        .carousel-slide.active { display: block; }
        .carousel-img { 
            width: 100%; height: 100%; object-fit: contain; 
            cursor: zoom-in; 
        }

        .nav-btn {
            position: absolute;
            top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white; border: none; cursor: pointer;
            padding: 12px; border-radius: 50%; font-size: 18px;
            transition: 0.2s; z-index: 10;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.9); color: black; }
        .prev-btn { left: 5px; }
        .next-btn { right: 5px; }
        .photo-counter { font-size: 12px; color: #999; text-align: center; margin-top: 5px; }
        .no-photo-text { display:flex; height:100%; align-items:center; justify-content:center; color:#888; font-size:13px; }

        /* --- 5. æ–°å¢ï¼šè·³è½¬æŒ‰é’®æ ·å¼ --- */
        .jump-btn {
            display: block;
            width: 100%;
            padding: 12px 0;
            background-color: #0062cc;
            color: white !important;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.2s;
            box-sizing: border-box; /* ç¡®ä¿å†…è¾¹è·ä¸æ’‘å¤§å®½åº¦ */
        }
        .jump-btn:hover {
            background-color: #004a99;
        }
        .jump-btn:visited { color: white !important; }

        #lightbox {
            display: none; /* é»˜è®¤éšè— */
            position: fixed;
            z-index: 9999; /* æœ€é¡¶å±‚ */
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.9); /* é»‘è‰²åŠé€æ˜èƒŒæ™¯ */
            align-items: center;
            justify-content: center;
            cursor: zoom-out;
        }
        #lightbox img {
            max-width: 95%;
            max-height: 95%;
            border-radius: 4px;
            box-shadow: 0 0 20px rgba(255,255,255,0.1);
            animation: zoomIn 0.2s ease-out;
        }
        @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* --- 6. ç§»åŠ¨ç«¯é€‚é… --- */
        @media (max-width: 600px) {
            .leaflet-popup-content { width: 85vw !important; min-width: 300px; }
            .popup-header { padding: 12px; }
            .popup-body { max-height: 70vh; padding: 12px; }
            .my-notes-list li { margin-bottom: 6px; }
            .carousel-container { height: 200px; }
            .nav-btn { padding: 15px; }
        }
    </style>
</head>
<body>

<div id="map"></div>

<div id="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img" src="" alt="Full Screen Photo">
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. åˆå§‹åŒ–åœ°å›¾
    var map = L.map('map', {
        tap: false // ä¿®å¤éƒ¨åˆ†ç§»åŠ¨ç«¯ç‚¹å‡»ç©¿é€é—®é¢˜
    }).setView([37.8, 106.2], 7);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Â© OpenStreetMap'
    }).addTo(map);

    // ============================================================
    // 2. æ·±åº¦ä¼˜åŒ–çš„åœ°ç‚¹æ•°æ® (å«æ”»ç•¥çº§è¯¦ç»†ä¿¡æ¯)
    // ============================================================
    var locations = [
        {
            name: "è§ˆå±±å…¬å›­",
            coords: [38.53051817738171, 106.21238831218719],
            myNotes: ["å¤ç½—é©¬å¼çš„å»ºç­‘", "æ‹ç…§å‡ºç‰‡"],
            desc: "<strong>ã€æœ€ä½³æ—¶åˆ»ã€‘</strong> æ¨èå‚æ™šå‰å¾€ã€‚å¤•é˜³è¥¿ä¸‹æ—¶ï¼Œé€è¿‡ä»¿å¤ç½—é©¬æ–—å…½åœºçš„æ‹±é—¨æ‹æ‘„å¯¹é¢çš„é˜…æµ·æ¹–å’Œè´ºå…°å±±è„‰ï¼Œæ˜¯é“¶å·æœ€ç»å…¸çš„æ‰“å¡æœºä½ã€‚<br><strong>ã€Tipsã€‘</strong> å…è´¹å¼€æ”¾ã€‚å°é˜¶è¾ƒå¤šï¼Œå»ºè®®ç©¿èˆ’é€‚çš„é‹ã€‚",
            tags: ["ç½‘çº¢æ‰“å¡", "æ—¥è½ç»ç»å­", "å…è´¹"],
            link: "https://hk.trip.com/travel-guide/attraction/yinchuan/yinchuan-lanshan-park-56808448/",
            photos: [
                "https://ak-d.tripcdn.com/images/0101c12000f6te36qE95A_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0106r12000nm0iikzCC51_C_1200_800_Q70.jpg", 
                "https://ak-d.tripcdn.com/images/0106o1200092lvrsd03DA_C_1200_800_Q70.jpg"
            ] 
        },
        {
            name: "è´ºå…°å±±å›½å®¶æ£®æ—å…¬å›­",
            coords: [38.75322411387948, 105.95248700167814],
            myNotes: ["ä¼¼ä¹æœ‰é›ª", "æ‹æ˜Ÿç©º", "æœ‰å²©ç¾Š"],
            desc: "<strong>ã€æ ¸å¿ƒçœ‹ç‚¹ã€‘</strong> å®å¤çš„çˆ¶äº²å±±ã€‚è¿™é‡Œå¯ä»¥è¿‘è·ç¦»çœ‹åˆ°è“è‰²çš„é‡ç”Ÿå²©ç¾Šï¼ˆä¸æ€•äººï¼‰ã€‚æ™¯åŒºå†…çš„'é’é˜³æ¹–'å’Œ'æ¾æ¶›å±±åº„'æ™¯è‰²ä¸é”™ã€‚<br><strong>ã€æ³¨æ„ã€‘</strong> å±±é‡Œæ¸©å·®å¤§ï¼Œå³ä½¿å¤å¤©ä¹Ÿè¦å¸¦å¤–å¥—ã€‚ç›¸æ¯”å…­ç›˜å±±ï¼Œè¿™é‡Œæ›´ç²—çŠ·è’å‡‰ã€‚",
            tags: ["ç™»å±±", "é‡ç”ŸåŠ¨ç‰©", "é¿æš‘"],
            link: "https://hk.trip.com/travel-guide/attraction/helan/ning-xia-helan-mountain-national-forest-park-80231/",
            photos: [
                "https://ak-d.tripcdn.com/images/0106y12000lir3v400C4F_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1lo2f12000h2nj8z5E87F_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0105312000f9ag9dj2FB6_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0104l12000lir3vtm3486_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1lo5c12000h2nkedw235F_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "è´ºå…°å±±å²©ç”»",
            coords: [38.745524629182434, 106.02031187736007],
            myNotes: ["è¿œå¤äººçš„å²©ç”»"],
            desc: "<strong>ã€å†å²ä»·å€¼ã€‘</strong> è·ä»Š3000-10000å¹´ã€‚æœ€è‘—åçš„æ˜¯'å¤ªé˜³ç¥'å²©ç”»ï¼Œä½äºé«˜å¤„ã€‚<br><strong>ã€æ¸¸ç©å»ºè®®ã€‘</strong> æ™¯åŒºæœ‰æ‘†æ¸¡è½¦ã€‚å¦‚æœå¯¹äººæ–‡å†å²ä¸æ„Ÿå…´è¶£ï¼Œå¯èƒ½ä¼šè§‰å¾—åªæ˜¯çœ‹å‡ å—çŸ³å¤´ï¼Œå»ºè®®å¬è®²è§£æˆ–ç§Ÿè®²è§£å™¨ã€‚",
            tags: ["äººæ–‡å†å²", "ä¸–ç•Œçº§é—äº§"],
            link: "https://hk.trip.com/travel-guide/attraction/helan/helan-mountain-rock-painting-77476/",
            photos: [
                "https://ak-d.tripcdn.com/images/1lo2z12000cw8758o07AD_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0HJ2y12000or0f3hsA904_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0HJ4512000ph8pji72E9D_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1lo3312000cw86ktj575D_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "å…­ç›˜å±± (çº¢å†›é•¿å¾æ™¯åŒº)",
            coords: [35.668980862413996, 106.20431099777802],
            myNotes: ["äº‘æµ·"],
            desc: "<strong>ã€åœ°ç†ç‰¹è‰²ã€‘</strong> è¿™é‡Œä¸åƒè¥¿åŒ—ï¼Œæ›´åƒæ±Ÿå—ã€‚æ°”å€™æ¹¿æ¶¦ï¼Œæ£®æ—è¦†ç›–ç‡æé«˜ï¼Œè¢«ç§°ä¸º'é«˜åŸç»¿å²›'ã€‚<br><strong>ã€çœ‹ç‚¹ã€‘</strong> çºªå¿µé¦†ã€çºªå¿µäº­ã€‚å¦‚æœè¿æ°”å¥½ï¼Œæ¸…æ™¨èƒ½çœ‹åˆ°å£®è§‚çš„äº‘æµ·æ—¥å‡ºã€‚é€‚åˆå¤å­£é¿æš‘ã€‚",
            tags: ["é¿æš‘èƒœåœ°", "çº¢è‰²æ—…æ¸¸", "äº‘æµ·"],
            link: "https://hk.trip.com/travel-guide/attraction/longde/liupanshan-changzheng-scenic-area-10795050/",
            photos: [
                "https://ak-d.tripcdn.com/images/0100t1200086mk6kbACFC_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0105n1200086mjtl6C03D_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0103l1200086mjsxe3E1D_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/010181200086mjwe95617_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "æ²™æ¹–",
            coords: [38.79790210185706, 106.38370520629081],
            myNotes: ["ä¸€åŠæ¹–ä¸€åŠæ²™", "éœ€é—¨ç¥¨"],
            desc: "<strong>ã€ç©æ³•ã€‘</strong> è¿›é—¨å…ˆåå¤§èˆ¹ç©¿è¿‡èŠ¦è‹‡è¡ï¼ˆè§‚é¸Ÿï¼‰ï¼Œåˆ°è¾¾å¯¹å²¸çš„æ²™æ¼ åŒºã€‚å¯ä»¥éª‘éª†é©¼ã€ç©æ²™ã€‚<br><strong>ã€é¿å‘ã€‘</strong> æ™¯åŒºç‰©ä»·ç¨è´µã€‚å¦‚æœä¸ç©æ°´ä¸Šé¡¹ç›®ï¼Œå¯èƒ½ä¼šè§‰å¾—æ€§ä»·æ¯”ä¸å¦‚æ²™å¡å¤´ã€‚",
            tags: ["è§‚é¸Ÿ", "5Aæ™¯åŒº", "äº²å­"],
            link: "https://hk.trip.com/travel-guide/attraction/pingluo/sand-lake-101072/",
            photos: [
                "https://ak-d.tripcdn.com/images/350r14000000x37c89704_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/350g14000000x5gwpB16C_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/350814000000x4yy3BACF_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/350f14000000x4syo6D54_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "é¡»å¼¥å±±çŸ³çªŸ & ç«çŸ³å¯¨",
            coords: [36.28068757177997, 105.98620744907183],
            myNotes: ["çœ‹å±±å’Œä½›åƒ", "æŒºä¸€èˆ¬çš„"],
            desc: "<strong>ã€é¡»å¼¥å±±ã€‘</strong> ä¹Ÿæ˜¯ä¸¹éœåœ°è²Œä¸Šçš„çŸ³çªŸï¼Œå¤§ä½›éå¸¸å£®è§‚ï¼Œç»å†äº†åœ°éœ‡ä¾ç„¶å±¹ç«‹ã€‚<br><strong>ã€ç«çŸ³å¯¨ã€‘</strong> ä¸­å›½åŒ—æ–¹æœ€å…¸å‹çš„ä¸¹éœåœ°è²Œï¼Œå±±ä½“çº¢å¦‚ç«ç„°ã€‚å¦‚æœä¸é¡ºè·¯ï¼Œç¡®å®ä¸å¿…ç‰¹æ„è·‘ä¸€è¶Ÿã€‚",
            tags: ["çŸ³çªŸè‰ºæœ¯", "ä¸¹éœåœ°è²Œ"],
            link: "https://hk.trip.com/travel-guide/attraction/guyuan/xumishan-grottoes-83188/",
            photos: [
                "https://ak-d.tripcdn.com/images/0106g1200086mk6myBBB7_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0100w1200086mk9woB952_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/010201200086mk6mtE9B7_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "æ°´æ´æ²Ÿ",
            coords: [38.292907747802076, 106.51605972669465],
            myNotes: ["çœ‹å¤ä»£å†å²", "é‡äºº"],
            desc: "<strong>ã€ä½“éªŒã€‘</strong> è¿™æ˜¯ä¸€ä¸ª'äº¤é€šå·¥å…·å¤§èµ'æ™¯åŒºï¼šä»æ¯›é©´è½¦ã€éª†é©¼è½¦ã€ç”šè‡³åˆ°æ‹–æ‹‰æœºã€‚æ ¸å¿ƒçœ‹ç‚¹æ˜¯è—å…µæ´ï¼ˆå¤ä»£åœ°é“æˆ˜ï¼‰ï¼Œéå¸¸ç²¾å¦™ã€‚<br><strong>ã€è¡¨æ¼”ã€‘</strong> å¿…çœ‹ã€ŠåŒ—ç–†å¤©æ­Œã€‹é©¬æˆ˜è¡¨æ¼”ï¼Œå¾ˆéœ‡æ’¼ã€‚",
            tags: ["è€ƒå¤", "å†›äº‹åœ°é“", "è¶£å‘³ä½“éªŒ"],
            link: "https://hk.trip.com/travel-guide/attraction/lingwu/shuidonggou-tourist-attraction-83196/",
            photos: [
                "https://ak-d.tripcdn.com/images/1lo0k12000cod1h733D56_C_1200_800_Q70.png",
                "https://ak-d.tripcdn.com/images/0106p120008ayqzgp87F2_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/100q0q000000gef4q5A12_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0104m120008ayr06cB49B_C_1200_800_Q70.jpg"

            ]
        },
        {
            name: "é€šæ¹–è‰åŸ",
            coords: [37.53909565056128, 105.12117642183082],
            myNotes: ["æ¹–+è‰åŸ+ç¾Š+æ²™æ¼ ", "åˆºé™µå–æ™¯"],
            desc: "<strong>ã€ä½ç½®ã€‘</strong> å…¶å®åœ¨å†…è’™å¤å¢ƒå†…ï¼Œç¦»ä¸­å«å¾ˆè¿‘ã€‚å·ç§°'æ²™æ¼ ä¼Šç”¸å›­'ã€‚<br><strong>ã€ç‰¹è‰²ã€‘</strong> æ™šä¸Šæœ‰ç››å¤§çš„ç¯ç«æ™šä¼šï¼Œæ°”æ°›å¾ˆå¥½ã€‚è¿™é‡Œèƒ½åŒæ—¶æ‹åˆ°è‰åŸã€æ²™æ¼ å’Œæ¹–æ³ŠåŒæ¡†çš„ç”»é¢ã€‚",
            tags: ["è‰åŸé£æƒ…", "ç¯ç«æ™šä¼š"],
            link: "https://hk.trip.com/travel-guide/attraction/alxa-left-banner/tonghu-grassland-tourist-areas-93865/",
            photos: [
                "https://ak-d.tripcdn.com/images/0101y12000467xcau60D5_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0100512000467wf5u7640_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0107212000467w45sF624_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "é•‡åŒ—å ¡è¥¿éƒ¨å½±åŸ",
            coords: [38.62038711576312, 106.07683275525224],
            myNotes: ["å¤§è¯è¥¿æ¸¸å–æ™¯åœ°"],
            desc: "<strong>ã€å¿…åšã€‘</strong> ç§Ÿä¸€å¥—ç´«éœä»™å­æˆ–è‡³å°Šå®çš„è¡£æœæ‹ç…§ï¼å‡ ä¹æ‰€æœ‰äººéƒ½åœ¨cosplayã€‚<br><strong>ã€çœ‹ç‚¹ã€‘</strong> åˆ†æ¸…åŸã€æ˜åŸã€è€é“¶å·ä¸€æ¡è¡—ã€‚é‚£ä¸ªç»å…¸çš„åŸå¢™ä¹‹å»å°±åœ¨è¿™é‡Œã€‚è™½ç„¶å…¨æ˜¯åœŸå¢™ï¼Œä½†æƒ…æ€€æ»¡åˆ†ã€‚",
            tags: ["ç”µå½±æœåœ£", "æ‹ç…§åœ£åœ°"],
            link: "https://hk.trip.com/travel-guide/attraction/yinchuan/china-west-film-studio-10558661/",
            photos: [
                "https://ak-d.tripcdn.com/images/100b0z000000nno059EBF_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/100m0z000000nt098E46A_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0101312000iw3n2wpADF0_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1A0v16000000zex2fB9EB_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/fd/tg/g2/M05/57/90/CghzgVSzWNyAM__tACBFqPRhWHE686_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "è¥¿å¤ç‹é™µ",
            coords: [38.42921989921511, 105.99779715070514],
            myNotes: ["ä¸œæ–¹é‡‘å­—å¡”", "æœ¬åœ°äººæ¨èåˆ«å»"],
            desc: "<strong>ã€ä¸ºä»€ä¹ˆå»ã€‘</strong> äº†è§£é‚£ä¸ªç¥ç§˜æ¶ˆå¤±çš„è¥¿å¤ç‹æœã€‚<strong>ã€ä¸ºä»€ä¹ˆä¸æ¨èã€‘</strong> å¦‚æœä¸çœ‹åšç‰©é¦†ï¼Œåªçœ‹é™µå¢“ï¼Œå°±æ˜¯å‡ ä¸ªå¤§åœŸå †ã€‚<br><strong>ã€å»ºè®®ã€‘</strong> å¿…é¡»å…ˆè®¤çœŸé€›åšç‰©é¦†ï¼ˆä¸‰é¦†ï¼‰ï¼Œå†å»çœ‹é™µå¡”ï¼Œé‚£ç§è‹å‡‰æ„Ÿæ‰å‡ºå¾—æ¥ã€‚",
            tags: ["å†å²é—è¿¹", "åšç‰©é¦†"],
            link: "https://hk.trip.com/travel-guide/attraction/yinchuan/the-western-xia-mausoleum-77480/",
            photos: [
                "https://ak-d.tripcdn.com/images/10080s000000hjmii1433_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/350a1900000178zoy1125_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/10020s000000hqiex1EA8_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/350r19000001763en828B_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "ä¸­å«66å·å…¬è·¯",
            coords: [37.40135086294266, 104.8593605401571],
            myNotes: ["æ‹å…¬è·¯ç…§", "æ„Ÿè§‰æŒºå‡ºç‰‡çš„ï¼ˆç¾å›½å…¬è·¯é£æ ¼ï¼‰"],
            desc: "<strong>ã€æ³¨æ„ã€‘</strong> è¿™æ˜¯ä¸€æ¡é€šå¾€å¤æ‘è½çš„çœŸå®å…¬è·¯ï¼Œè½¦é€Ÿå¾ˆå¿«ï¼<strong>æ‹ç…§ä¸€å®šè¦æ³¨æ„å®‰å…¨</strong>ï¼Œä¸è¦ä¸€ç›´åœ¨è·¯ä¸­é—´èººç€ã€‚<br><strong>ã€æœ€ä½³æœºä½ã€‘</strong> Uå‹è°·è·¯æ®µï¼ŒèƒŒæ™¯æ˜¯é»„è¤è‰²çš„è’å±±ï¼Œéå¸¸ç¾å¼ã€‚",
            tags: ["å…¬è·¯å¤§ç‰‡", "å…è´¹"],
            link: "https://hk.trip.com/travel-guide/attraction/zhongwei/no66-road-102734185/",
            photos: [
                "https://ak-d.tripcdn.com/images/0103a12000h0zoppi0BEC.jpg", 
                "https://ak-d.tripcdn.com/images/0106o1200092lvrsd03DA_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/010011200092lvepg416F_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "ä¹Œå…°æ¹–ï¼ˆäº”æ¹–ç©¿è¶Šï¼‰",
            coords: [44.62026182536693, 103.6176843060086],
            myNotes: ["è¦åè¶Šé‡è½¦ç©¿è¶Š", "åœ°çƒå¿ƒè„"],
            desc: "<strong>ã€ç¡¬æ ¸è­¦å‘Šã€‘</strong> å¿…é¡»åŒ…è½¦æˆ–è·Ÿå›¢ï¼Œè‡ªé©¾æ— æ³•è¿›å…¥æ²™æ¼ æ·±å¤„ã€‚éå¸¸é¢ ç°¸ï¼Œå®¹æ˜“æ™•è½¦ã€‚<br><strong>ã€ä¹Œå…°æ¹–ã€‘</strong> å­£èŠ‚æ€§æ¹–æ³Šï¼Œæœ€çº¢çš„æ—¶å€™åƒé²œè¡€ä¸€æ ·ï¼Œè¢«èª‰ä¸º'åœ°çƒå¿ƒè„'ï¼Œæ— äººæœºè§†è§’ç»ç¾ã€‚",
            tags: ["è¶Šé‡åˆºæ¿€", "æ‘„å½±ç§˜å¢ƒ"],
            link: "https://hk.trip.com/travel-guide/attraction/alxa-left-banner/ulaan-lake-134024856/",
            photos: [
                "https://ak-d.tripcdn.com/images/1mh0b12000h8wpemc98BC_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1mh0k12000luur138A15A_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1mh0v12000jx8x1nt4429_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "è…¾æ ¼é‡Œæ²™æ¼ ",
            coords: [37.59797027962138, 105.08200097519618],
            myNotes: ["æ²™æ¼ é¡¹ç›®"],
            desc: "<strong>ã€ä½“éªŒã€‘</strong> æ²™è´¨éå¸¸ç»†è½¯ã€‚å¯ä»¥ç©æ²™æ¼ è¶Šé‡è½¦ã€æ»‘æ²™ã€‚<br><strong>ã€ä½å®¿ã€‘</strong> å¦‚æœé¢„ç®—å……è¶³ï¼Œå¯ä»¥ä½“éªŒæ²™æ¼ é‡Œçš„'æ˜Ÿæ˜Ÿé…’åº—'ï¼Œæ™šä¸Šçœ‹é“¶æ²³éå¸¸éœ‡æ’¼ã€‚",
            tags: ["æ²™æ¼ å¾’æ­¥", "è§‚æ˜Ÿ"],
            link: "https://hk.trip.com/travel-guide/attraction/zhongwei/tengger-desert-56807516/",
            photos: [
                "https://ak-d.tripcdn.com/images/01039120004fdztc683C0_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0106012000hnrn0mv3A33_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/1mh1e12000nsju9h87D6C_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "é»„æ²™å¤æ¸¡åŸç”Ÿæ€æ—…æ¸¸åŒº",
            coords: [38.487150570498, 106.2059220305729],
            myNotes: ["æ²™å¡å¤´ä¸‹ä½æ›¿ä»£", "ä¾¿å®œ"],
            desc: "<strong>ã€æ€§ä»·æ¯”ä¹‹ç‹ã€‘</strong> è¿™é‡Œçš„é—¨ç¥¨é€šå¸¸åŒ…å«å¤šç§å¨±ä¹é¡¹ç›®ï¼ˆä¸€ç¥¨é€šï¼‰ï¼Œä¸ç”¨è¿›å»å†æŒ¨ä¸ªæé’±ã€‚è™½ç„¶é£æ™¯ç•¥é€Šæ²™å¡å¤´ï¼Œä½†ç©å¾—çˆ½ã€‚",
            tags: ["é«˜æ€§ä»·æ¯”", "ä¸€ç¥¨é€šç©"],
            link: "https://hk.trip.com/travel-guide/attraction/yinchuan/huangshagudu-tourism-scenic-spot-10758164/",
            photos: [
                "https://ak-d.tripcdn.com/images/350s180000015b38o596F_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0106h120009dom8pv236B_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0102d120008hk0fgr5576_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0103f120008hk0d7m3C4A_C_1200_800_Q70.jpg"
            ]
        },
        {
            name: "æ²™å¡å¤´",
            coords: [37.519288671778966, 105.175168089269],
            myNotes: ["å„ç§é¡¹ç›®", "é»„æ²³åŒº", "æ²™æ¼ åŒº"],
            desc: "<strong>ã€æ”»ç•¥ã€‘</strong> åˆ†å—åŒ—ä¸¤åŒºã€‚å—åŒºçœ‹é»„æ²³ï¼Œç©ç¾Šçš®ç­å­ã€é»„æ²³é£ç´¢ï¼ˆå¿…ç©ï¼‰ï¼›åŒ—åŒºçœ‹æ²™æ¼ ï¼Œéª‘éª†é©¼ã€‚<br><strong>ã€ç‰¹è‰²ã€‘</strong> è¿™é‡Œæ˜¯ç‹ç»´ã€Šä½¿è‡³å¡ä¸Šã€‹çš„å†™å®åœ°ã€‚ä¸€å®šè¦ä½“éªŒåœ¨é»„æ²³ä¸Šåç¾Šçš®ç­å­çš„æ„Ÿè§‰ã€‚",
            tags: ["å¿…å»", "é»„æ²³æ–‡åŒ–", "5Aæ™¯åŒº"],
            link: "https://hk.trip.com/travel-guide/attraction/zhongwei/shapotou-scenic-area-83186/",
            photos: [
                "https://ak-d.tripcdn.com/images/0105i1200087cug2hF275_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/010011200080zcbgn1BB0_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0HJ4912000o2wk7m62658_C_1200_800_Q70.jpg",
                "https://ak-d.tripcdn.com/images/0105p1200086q6lr5BFE8_C_1200_800_Q70.jpg"
            ]
        }
    ];

    // ============================================================
    // 3. é€»è¾‘å¤„ç†
    // ============================================================

    var currentSlideIndices = {};

    locations.forEach(function(loc) {
        var marker = L.marker(loc.coords).addTo(map);
        
        marker.bindTooltip(loc.name, {
            permanent: true, direction: 'bottom', offset: [0, 5], className: 'map-label', interactive: true
        });

        var content = buildPopupContent(loc);
        marker.bindPopup(content, { maxWidth: 400, autoPan: true });
        marker.on('popupopen', function() { if (loc.photos && loc.photos.length > 0) renderCarousel(loc); });
    });

    function buildPopupContent(loc) {
        var notesHtml = loc.myNotes && loc.myNotes.length ? 
            `<div class="my-notes-box"><span class="section-title">ğŸ“ æˆ‘çš„ç¬”è®°</span><ul class="my-notes-list">${loc.myNotes.map(n=>`<li>${n}</li>`).join('')}</ul></div>` : '';

        var tagsHtml = `<div class="tag-container">${(loc.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>`;

        var safeName = loc.name.replace(/[^\w\u4e00-\u9fa5]/g, '');
        var hasPhotos = loc.photos && loc.photos.length > 0;
        var carouselHtml = hasPhotos ? 
            `<div class="carousel-container">
                <button class="nav-btn prev-btn" onclick="changeSlide('${safeName}', -1)">â®</button>
                <div id="slides-${safeName}" style="height:100%"></div>
                <button class="nav-btn next-btn" onclick="changeSlide('${safeName}', 1)">â¯</button>
            </div>
            <div class="photo-counter" id="counter-${safeName}">1 / ${loc.photos.length}</div>` 
            : `<div class="carousel-container"><div class="no-photo-text">ğŸ“· æš‚æ— ç…§ç‰‡ï¼Œå¾…ä½ å®åœ°æ‹æ‘„</div></div>`;

        // æŒ‰é’®åŒºåŸŸ
        var jumpBtnHtml = loc.link ? 
            `<a href="${loc.link}" target="_blank" class="jump-btn"><i class="fas fa-external-link-alt"></i> æŸ¥çœ‹ Trip.com è¯¦ç»†æ”»ç•¥</a>` : '';

        return `
            <div class="popup-header"><span>${loc.name}</span><i class="fas fa-map-marked-alt"></i></div>
            <div class="popup-body">
                ${notesHtml}
                <div class="desc-box">${tagsHtml}${loc.desc}</div>
                <div class="photo-section"><span class="section-title">ğŸ“¸ ç°åœºå®æ‹ (ç‚¹å‡»æ”¾å¤§)</span>${carouselHtml}</div>
                ${jumpBtnHtml}
            </div>
        `;
    }

    function renderCarousel(loc) {
        var safeName = loc.name.replace(/[^\w\u4e00-\u9fa5]/g, '');
        var container = document.getElementById(`slides-${safeName}`);
        if (!container) return;

        if (!currentSlideIndices[safeName]) currentSlideIndices[safeName] = 0;
        var idx = currentSlideIndices[safeName];

        container.innerHTML = '';
        loc.photos.forEach((src, index) => {
            var div = document.createElement('div');
            div.className = index === idx ? 'carousel-slide active' : 'carousel-slide';
            // è¿™é‡Œç»‘å®šäº† onclick äº‹ä»¶ï¼Œè§¦å‘ openLightbox
            div.innerHTML = `<img src="${src}" class="carousel-img" onclick="openLightbox('${src}')">`;
            container.appendChild(div);
        });

        var counter = document.getElementById(`counter-${safeName}`);
        if(counter) counter.innerText = `${idx + 1} / ${loc.photos.length}`;
    }

    // --- Lightbox åŠŸèƒ½ ---
    window.openLightbox = function(src) {
        var lightbox = document.getElementById('lightbox');
        var img = document.getElementById('lightbox-img');
        img.src = src;
        lightbox.style.display = 'flex';
    }

    window.closeLightbox = function() {
        document.getElementById('lightbox').style.display = 'none';
    }

    window.changeSlide = function(safeName, step) {
        var loc = locations.find(l => l.name.replace(/[^\w\u4e00-\u9fa5]/g, '') === safeName);
        if (!loc) return;
        var idx = currentSlideIndices[safeName] || 0;
        var newIndex = idx + step;
        if (newIndex >= loc.photos.length) newIndex = 0;
        if (newIndex < 0) newIndex = loc.photos.length - 1;
        currentSlideIndices[safeName] = newIndex;
        renderCarousel(loc);
    };

</script>
</body>
</html>
